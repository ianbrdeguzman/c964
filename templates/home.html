<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ben's Barrel of Red</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="h-screen text-gray-700">
    <div class="w-full p-4 h-screen">
      <h1 class="text-center mb-2 font-bold text-3xl">Ben's Barrel of Red</h1>
      <div class="w-full flex flex-col gap-4 md:flex-row md:items-start">
        <div class="flex flex-col gap-4 lg:min-w-80">
          <div class="bg-white shadow-md rounded p-8">
            <h2 class="text-center mb-2 font-bold text-xl">
              Top Predictions ğŸ†
            </h2>
            <table class="w-full">
              <tr>
                <th>Date</th>
                <th>Prediction</th>
              </tr>
              {% for prediction in top_predictions %}
              <tr>
                <td>{{prediction[13]}}</td>
                <td class="text-right">{{"{:.2f}".format(prediction[12])}}</td>
              </tr>
              {% endfor %}
            </table>
          </div>
          <div class="bg-white shadow-md rounded p-8">
            <h2 class="text-center mb-2 font-bold text-xl">
              Recent Predictions â°
            </h2>
            <table class="w-full">
              <tr>
                <th>Date</th>
                <th>Prediction</th>
              </tr>
              {% for prediction in recent_predictions %}
              <tr>
                <td>{{prediction[13]}}</td>
                <td class="text-right">{{"{:.2f}".format(prediction[12])}}</td>
              </tr>
              {% endfor %}
            </table>
          </div>
        </div>
        <form
          action="/"
          method="POST"
          class="bg-white shadow-md rounded p-8 flex-1"
        >
          <fieldset {% if prediction %} disabled="true" {% endif %}>
            <div class="mb-4 text-sm">
              <div class="flex justify-between items-center mb-2">
                <label for="fixed_acidity">Fixed Acidity ğŸ§ªğŸ’§</label>
                <span id="fixed_acidity_value">0</span>
              </div>
              <input
                class="border rounded w-full"
                min="0"
                value="{{fixed_acidity}}"
                max="20"
                step="any"
                id="fixed_acidity"
                name="fixed_acidity"
                type="range"
              />
            </div>
            <div class="mb-4 text-sm">
              <div class="flex justify-between items-center mb-2">
                <label for="volatile_acidity">Volatile Acidity ğŸ§ªğŸ”¥</label>
                <span id="volatile_acidity_value">0</span>
              </div>
              <input
                class="border rounded w-full"
                min="0"
                value="{{volatile_acidity}}"
                max="2"
                step="any"
                id="volatile_acidity"
                name="volatile_acidity"
                type="range"
              />
            </div>
            <div class="mb-4 text-sm">
              <div class="flex justify-between items-center mb-2">
                <label for="citric_acid">Citric Acid ğŸ‹ğŸ§ª</label>
                <span id="citric_acid_value">0</span>
              </div>
              <input
                class="border rounded w-full"
                min="0"
                value="{{citric_acid}}"
                max="1"
                step="any"
                id="citric_acid"
                name="citric_acid"
                type="range"
              />
            </div>
            <div class="mb-4 text-sm">
              <div class="flex justify-between items-center mb-2">
                <label for="residual_sugar">Residual Sugar ğŸ¬ğŸ”„</label>
                <span id="residual_sugar_value">0</span>
              </div>
              <input
                class="border rounded w-full"
                min="0"
                value="{{residual_sugar}}"
                max="20"
                step="any"
                id="residual_sugar"
                name="residual_sugar"
                type="range"
              />
            </div>
            <div class="mb-4 text-sm">
              <div class="flex justify-between items-center mb-2">
                <label for="chlorides">Chlorides ğŸ§‚ğŸ”¬</label>
                <span id="chlorides_value">0</span>
              </div>
              <input
                class="border rounded w-full"
                min="0"
                value="{{chlorides}}"
                max="1"
                step="any"
                id="chlorides"
                name="chlorides"
                type="range"
              />
            </div>
            <div class="mb-4 text-sm">
              <div class="flex justify-between items-center mb-2">
                <label for="free_sulfur_dioxide"
                  >Free Sulfur Dioxide ğŸ†“ğŸ§ªğŸŸ¡</label
                >
                <span id="free_sulfur_dioxide_value">0</span>
              </div>
              <input
                class="border rounded w-full"
                min="1"
                value="{{free_sulfur_dioxide}}"
                max="100"
                step="any"
                id="free_sulfur_dioxide"
                name="free_sulfur_dioxide"
                type="range"
              />
            </div>
            <div class="mb-4 text-sm">
              <div class="flex justify-between items-center mb-2">
                <label for="total_sulfur_dioxide"
                  >Total Sulfur Dioxide â•ğŸ§ªğŸŸ¡</label
                >
                <span id="total_sulfur_dioxide_value">0</span>
              </div>
              <input
                class="border rounded w-full"
                min="0"
                value="{{total_sulfur_dioxide}}"
                max="300"
                step="any"
                id="total_sulfur_dioxide"
                name="total_sulfur_dioxide"
                type="range"
              />
            </div>
            <div class="mb-4 text-sm">
              <div class="flex justify-between items-center mb-2">
                <label for="density">Density ğŸ“âš–ï¸</label>
                <span id="density_value">0</span>
              </div>
              <input
                class="border rounded w-full"
                min="0"
                value="{{density}}"
                max="1"
                step="any"
                id="density"
                name="density"
                type="range"
              />
            </div>
            <div class="mb-4 text-sm">
              <div class="flex justify-between items-center mb-2">
                <label for="ph">PH ğŸ“‰âš—ï¸</label>
                <span id="ph_value">0</span>
              </div>
              <input
                class="border rounded w-full"
                min="0"
                value="{{ph}}"
                max="14"
                step="any"
                id="ph"
                name="ph"
                type="range"
              />
            </div>
            <div class="mb-4 text-sm">
              <div class="flex justify-between items-center mb-2">
                <label for="sulphates">Sulphates ğŸ’¨ğŸ§ª</label>
                <span id="sulphates_value">0</span>
              </div>
              <input
                class="border rounded w-full"
                min="0"
                value="{{sulphates}}"
                max="2"
                step="any"
                id="sulphates"
                name="sulphates"
                type="range"
              />
            </div>
            <div class="mb-4 text-sm">
              <div class="flex justify-between items-center mb-2">
                <label for="alcohol">Alcohol ğŸ·ğŸ§ª</label>
                <span id="alcohol_value">0</span>
              </div>
              <input
                class="border rounded w-full"
                min="0"
                value="{{alcohol}}"
                max="20"
                step="any"
                id="alcohol"
                name="alcohol"
                type="range"
              />
            </div>
            <div class="flex justify-between items-center">
              {% if prediction %}
              <a
                class="bg-rose-500 hover:bg-blue-700 text-white py-2 px-4 rounded focus:outline-none focus:shadow-outline"
                href="/"
              >
                Reset
              </a>
              {% else %}
              <button
                class="bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded focus:outline-none focus:shadow-outline disabled:bg-gray-700"
                type="submit"
              >
                Submit
              </button>
              {% endif %} {% if prediction %}
              <p>Quality: {{"{:.2f}".format(prediction)}}</p>
              {% endif %}
            </div>
          </fieldset>
        </form>
        <div class="flex flex-col gap-4 lg:min-w-80">
          <div
            class="flex flex-col items-center bg-white shadow-md rounded p-8"
          >
            <h2 class="text-center mb-2 font-bold text-xl">
              Quality vs Alcohol
            </h2>
            <image src="{{box_src}}" width="240" />
          </div>
          <div
            class="flex flex-col items-center bg-white shadow-md rounded p-8"
          >
            <h2 class="text-center mb-2 font-bold text-xl">Historgram</h2>
            <image src="{{histogram_src}}" width="240" />
          </div>
          <div
            class="flex flex-col items-center bg-white shadow-md rounded p-8"
          >
            <h2 class="text-center mb-2 font-bold text-xl">Heatmap</h2>
            <image src="{{heatmap_src}}" width="240" />
          </div>
        </div>
      </div>
    </div>
    <script>
      const inputMatrix = [
        ['#fixed_acidity', '#fixed_acidity_value'],
        ['#volatile_acidity', '#volatile_acidity_value'],
        ['#citric_acid', '#citric_acid_value'],
        ['#residual_sugar', '#residual_sugar_value'],
        ['#chlorides', '#chlorides_value'],
        ['#free_sulfur_dioxide', '#free_sulfur_dioxide_value'],
        ['#total_sulfur_dioxide', '#total_sulfur_dioxide_value'],
        ['#density', '#density_value'],
        ['#ph', '#ph_value'],
        ['#sulphates', '#sulphates_value'],
        ['#alcohol', '#alcohol_value']
      ];
      inputMatrix.forEach((row) => {
        const [inputSelector, valueSelector] = row;
        const inputElement = document.querySelector(inputSelector);
        const valueElement = document.querySelector(valueSelector);

        // set initial value
        valueElement.textContent = Number(inputElement.value).toFixed(2);
        // listen to input change
        inputElement.addEventListener('input', (e) => {
          valueElement.textContent = Number(e.target.value).toFixed(2);
        });
      });
    </script>
  </body>
</html>
